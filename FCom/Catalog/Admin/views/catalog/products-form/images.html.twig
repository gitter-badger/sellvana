{% set m = THIS.get('model') %}
{% set prodImagesConfig = APP.instance('FCom_Catalog_Admin_Controller_Products').productImagesGridConfig(m) %}

{% set type = 'images' %}
{% set targetType = 'product' %}
{% set medialibConfig = {id: 'all_' ~ type, type: 'product-images', title: 'Images', folder: 'media/product/images'} %}

{% set attachmentsConfig = {
    type: type,
    targetType: targetType,
    elementContainer: '#tab-images',
    medialibConfig: medialibConfig,
    gridConfig: prodImagesConfig
} %}

{#{{ forms.attachment_tab_content(m, attachment_tab_config) | raw }}#}

{{ THIS.view('core/attachmentgrid').set('config', attachmentsConfig) | raw }}


{#todo: load variants tab before update image list when add image for product #}
<script>
    window.afterAddImages = function (grid) {
        var image = [];
        grid.getSelectedRows().forEach(function (row) {
            image.push({
                file_id: row.get('file_id'),
                subfolder: row.get('subfolder'),
                file_name: row.get('file_name')
            })
        });
        if (typeof(updateListVariantImage) == "function") {
            updateListVariantImage({
                add: true,
                image: image
            });
        }
    }
</script>