{% set c = THIS.get('model') %}
{% set mode = c.get("mode_by_ip/FCom_Cron")|split("\n")|join('|') %}
{% set fieldData = { model: c, id_prefix:'FCom_Cron', name_prefix:'config[modules][FCom_Cron]' } %}
{% import THIS.view('admin/form-elements').twigName() as forms %}
<h2>{{ "Crontab Settings"|_}}</h2>
{{ forms.accordion_start({id:'settings-FCom_Cron'}) }}
     {{ forms.accordion_panel_start({label:'Area Settings'|_, id:'settings-FCom_Cron-group0', in:1}) }}
        <div class="form-group" >
            <label class="col-md-2 control-label">{{ "IP: Mode"|_ }}</label>
            <div class="col-md-8  group-ip-mode"></div>
        </div>
    {{ forms.accordion_panel_end }}
    {{ forms.accordion_panel_start({label:'Cron Dispatch'|_, id:'settings-FCom_Cron-group1'}) }}
        {{ forms.input(fieldData|merge({field:'leeway_mins', label:'Leeway Minutes'|_, value: c.get('modules/FCom_Cron/leeway_mins')})) }}
        {{ forms.input(fieldData|merge({field:'timeout_mins', label:'Timeout Minutes'|_, value: c.get('modules/FCom_Cron/timeout_mins')})) }}
        {{ forms.input(fieldData|merge({field:'wait_sec', label:'Wait Seconds'|_, value: c.get('modules/FCom_Cron/wait_sec')})) }}
    {{ forms.accordion_panel_end }}
{{ forms.accordion_end }}

<script  type="text/javascript">
    require(['backbone', 'jquery', 'fcom.ipmode','select2'], function(Backbone, $, ipMode) {
        var mode = '{{ mode }}';
        mode = mode.split('|');
        ipMode.initMode({el: $('#settings-FCom_Cron-group0').find('.group-ip-mode'), name: 'config[mode_by_ip][FCom_Cron]', mode: mode});
    })
</script>