<!--{ label: Reviews }-->
<!--{ pos: 10 }-->
{% set m = THIS.get('model') %}
{% set promo = APP.instance('FCom_Promo_Model_Promo') %}
{% set validator = THIS.get('validator') %}

{% import THIS.view('core/form-elements').twigName() as forms %}

{% if APP.m('FCom_CustomerGroups').run_status == 'LOADED' %}
    {% set customerGroups = APP.instance('FCom_CustomerGroups_Model_Group').groupsOptions() %}
{% endif %}

{% if APP.m('FCom_MultiSite').run_status == 'LOADED' %}
    {% set sites = APP.instance('FCom_MultiSite_Model_Site').siteOptions() %}
{% endif %}

<fieldset class="adm-section-group">
    <div class="f-section">
        {{ forms.input({label: 'Admin Summary'|_, required: 1, name: "model[admin_summary]",
            value: validator.fieldValue('admin_summary'),
            id: "model-admin_summary", help_icon: 1, help_text: 'Admin Summary'|_ }) }}
        {{ forms.textarea({label: 'Internal Notes'|_, name: "model[admin_notes]",
            value: validator.fieldValue('admin_notes'),
            id: "model-admin_notes", help_icon: 1, help_text: 'Internal Notes'|_ }) }}
        {{ forms.input({label: 'Customer Label'|_, required: 1, name: "model[customer_label]",
            value: validator.fieldValue('customer_label'),
            id: "model-customer_label", help_icon: 1, help_text: 'Customer Label'|_ }) }}
        {{ forms.textarea({label: 'Details for Customers'|_, name: "model[customer_details]",
            value: validator.fieldValue('customer_details'),
            id: "model-customer_details", help_icon: 1, help_text: 'Details for Customers'|_ }) }}

        {{ forms.select({
            label: 'Status'|_,
            name: "model[status]",
            value: validator.fieldValue('status'),
            id: "model-status", help_icon: 1,
            help_text: "Promotion status"|_,
            select2: 1, options: ['Pending'|_, 'Active'|_, 'Expired'|_],
            input_div_class: "col-md-2"
        }) }}


        {{ forms.input({label: 'Date Range'|_, required: 1, name: "model[date_range]",
            value: validator.fieldValue('date_range'),
            id: "model-date_range", help_icon: 1, help_text: 'Date Range'|_ }) }}
        <div id="testbed"></div>
        <script type="text/javascript">
            require(['jquery', 'moment', 'daterangepicker'], function ($) {
                var startDate = new Date();
                var s = startDate.getFullYear() + '-' + (startDate.getMonth() + 1) + '-' + startDate.getDate();
                $('#model-date_range').daterangepicker(
                    {
                        format: 'YYYY-MM-DD',
                        startDate: s
                    }
                );
            });

//            require(['react', 'jsx!fcom.promo'], function($) {
//                console.log('YES!');
//            })
        </script>
        {{ forms.select({
            label: 'Coupon Code Enter For Validity'|_,
            name: "model[use_coupon]",
            value: validator.fieldValue('use_coupon'),
            id: "model-use_coupon", help_icon: 1,
            help_text: "Require coupon code"|_,
            select2: 1, options: ['No coupon code required'|_, 'Single coupon code'|_, 'Multiple coupon codes'|_]
        }) }}

        <script type="text/jsx;harmony=true">
            require(['react', 'jsx!fcom.promo'], function (React, Promo) {
                var options = {
                    coupon_select_id: 'model-use_coupon',
                    showCouponsUrl: "{{ APP.href('promo/coupons/view?id=') ~ m.id() }}", // "/admin/promo/coupons/view?id=1",
                    generateCouponsUrl: "{{ APP.href('promo/coupons/generate?id=') ~ m.id() }}", // "/admin/promo/coupons/generate?id=1",
                    importCouponsUrl: "{{ APP.href('promo/coupons/import?id=') ~ m.id() }}", // "/admin/promo/coupons/import?id=1",
                    valueUpc: '',
                    valueUt: '',
                    singleCouponValue: ''
                };
                Promo.init(options);
            });
        </script>
    </div>
</fieldset>
