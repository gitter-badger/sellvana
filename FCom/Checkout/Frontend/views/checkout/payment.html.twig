{% set curMethod = THIS.get('cart').get('payment_method') %}
{% set payment_html = THIS.get('payment_html') %}
<form action="{{ APP.href('checkout/payment') }}" method="post" class="payment-method-form">
    <header class="main-title">
        <h1 class="title">{{ "Payment method" |_ }}</h1>
    </header>
    <fieldset>
            {% for method, class in THIS.get('payment_methods') %}
            <label class="radio">
              <input type="radio" class="payment_method radio" name="payment_method" value="{{ method }}" {{ method == curMethod ? 'checked' : '' }}>
                {{ class.getName() }}
            </label><br>
                {% if payment_html[method] %}
                 <div class="payment_html{{ method != curMethod ? ' hidden' : '' }}" id="payment_html_{{ method }}">
                     {{ payment_html[method] |raw}}
                 </div>
                {% endif %}
            {% endfor %}
        <button type="submit" class="btn btn-primary">{{ "Continue to checkout" |_ }}</button>
    </fieldset>
</form>
<script type="text/javascript">
    require(['jquery'], function($){
        $('.payment_method').click(function(){
            $('.payment_html').addClass('hidden').find('input, select, textarea').prop('disabled', true);
            $('#payment_html_' + this.value).removeClass('hidden').find('input, select, textarea').prop('disabled', false);
        });
    });
</script>